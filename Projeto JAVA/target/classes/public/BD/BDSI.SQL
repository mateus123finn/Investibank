
-- Tabela USUARIO
CREATE TABLE USUARIO (
    Cpf CHAR(11) NOT NULL,
    Pnome VARCHAR(80) NOT NULL,
    Unome VARCHAR(80) NOT NULL,
    Dt_Nascimento DATE NOT NULL,
    EMAIL VARCHAR(80) NOT NULL,
    Senha CHAR(32) NOT NULL,
    Valor DOUBLE PRECISION DEFAULT 0
);

-- Nova Tabela INVESTIMENTO
CREATE TABLE INVESTIMENTO (
    Sigla CHAR(8) NOT NULL,
    Nome VARCHAR(40) NOT NULL,
    Preco DOUBLE PRECISION NOT NULL,
    Moeda CHAR(3) NOT NULL
);

-- Tabela FAZ
CREATE TABLE FAZ (
    Investimento CHAR(8) NOT NULL,
    Usuario CHAR(11) NOT NULL,
    Nmr_Transacao INTEGER NOT NULL,
    Dt_Transacao DATE NOT NULL,
    Qnt_adquirida DOUBLE PRECISION NOT NULL,
    Valor_Total DOUBLE PRECISION NOT NULL,
    Ativo BOOLEAN DEFAULT TRUE
);

-- Constraints

ALTER TABLE USUARIO ADD CONSTRAINT PK_USUARIO PRIMARY KEY (Cpf);
--ALTER TABLE CARTEIRA ADD CONSTRAINT PK_CARTEIRA PRIMARY KEY (Id);
--ALTER TABLE METODOPAGAMENTO ADD CONSTRAINT PK_METODOPAGAMENTO PRIMARY KEY (Id, Carteira);
ALTER TABLE INVESTIMENTO ADD CONSTRAINT PK_INVESTIMENTO PRIMARY KEY (Sigla);
ALTER TABLE FAZ ADD CONSTRAINT PK_FAZ PRIMARY KEY (Investimento, Usuario);
--ALTER TABLE CARTEIRA ADD CONSTRAINT FK_CARTEIRA_USUARIO FOREIGN KEY (Usuario) REFERENCES USUARIO (Cpf) ON DELETE RESTRICT ON UPDATE CASCADE;
--ALTER TABLE INVESTIMENTO ADD CONSTRAINT FK_INVESTIMENTO_USUARIO FOREIGN KEY (Usuario) REFERENCES USUARIO (Cpf) ON DELETE RESTRICT ON UPDATE CASCADE;
--ALTER TABLE METODOPAGAMENTO ADD CONSTRAINT FK_METODOPAGAMENTO_CARTEIRA FOREIGN KEY (Carteira) REFERENCES CARTEIRA (Id) ON DELETE RESTRICT ON UPDATE CASCADE;
ALTER TABLE FAZ ADD CONSTRAINT FK_FAZ_USUARIO FOREIGN KEY (Usuario) REFERENCES USUARIO (Cpf) ON DELETE RESTRICT ON UPDATE CASCADE;
ALTER TABLE FAZ ADD CONSTRAINT FK_FAZ_INVESTIMENTO FOREIGN KEY (Investimento) REFERENCES INVESTIMENTO (Sigla) ON DELETE RESTRICT ON UPDATE CASCADE;
